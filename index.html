<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ’®å½±è¨˜éŒ²ã‚¢ãƒ—ãƒª</title>

<style>
body{
  margin:0;
  font-family:sans-serif;
  background:#f2f2f7;
}
header{
  background:#222;
  color:white;
  text-align:center;
  padding:15px;
  font-size:20px;
}
.container{
  padding:15px;
}
input, textarea{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:16px;
}
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:20px;
  background:#007aff;
  color:white;
  font-size:16px;
  margin-top:10px;
}
.card{
  background:white;
  padding:15px;
  margin:10px 0;
  border-radius:15px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
.card img{
  width:100%;
  border-radius:10px;
  margin-top:10px;
}
.delete{
  background:red;
  margin-top:10px;
}
</style>
</head>
<body>

<header>ğŸš† æ’®å½±è¨˜éŒ²ã‚¢ãƒ—ãƒª</header>

<div class="container">

<input id="line" placeholder="è·¯ç·šå">
<input id="number" placeholder="ç·¨æˆç•ªå·">
<input id="place" placeholder="æ’®å½±åœ°">
<input type="date" id="date">
<textarea id="memo" placeholder="ãƒ¡ãƒ¢"></textarea>
<input type="file" id="photo" accept="image/*">

<button onclick="addLog()">è¨˜éŒ²ã™ã‚‹</button>

<hr>

<input id="search" placeholder="æ¤œç´¢ï¼ˆè·¯ç·šãƒ»ç•ªå·ãªã©ï¼‰" oninput="loadLogs()">

<div id="logList"></div>

</div>

<script>
function addLog(){
  const reader = new FileReader();
  const file = document.getElementById("photo").files[0];

  reader.onload = function(){
    const log = {
      line: line.value,
      number: number.value,
      place: place.value,
      date: date.value,
      memo: memo.value,
      photo: reader.result || ""
    };

    let logs = JSON.parse(localStorage.getItem("trainLogs") || "[]");
    logs.unshift(log);
    localStorage.setItem("trainLogs", JSON.stringify(logs));

    clearForm();
    loadLogs();
  };

  if(file){
    reader.readAsDataURL(file);
  } else {
    reader.onload();
  }
}

function loadLogs(){
  const list = document.getElementById("logList");
  list.innerHTML = "";

  const search = document.getElementById("search").value.toLowerCase();
  let logs = JSON.parse(localStorage.getItem("trainLogs") || "[]");

  logs.forEach((log, index)=>{
    const text = (log.line + log.number + log.place + log.memo).toLowerCase();
    if(!text.includes(search)) return;

    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <strong>${log.line}</strong> (${log.number})<br>
      ğŸ“ ${log.place}<br>
      ğŸ“… ${log.date}<br>
      ğŸ“ ${log.memo}
      ${log.photo ? `<img src="${log.photo}">` : ""}
      <button class="delete" onclick="deleteLog(${index})">å‰Šé™¤</button>
    `;
    list.appendChild(div);
  });
}

function deleteLog(index){
  let logs = JSON.parse(localStorage.getItem("trainLogs") || "[]");
  logs.splice(index,1);
  localStorage.setItem("trainLogs", JSON.stringify(logs));
  loadLogs();
}

function clearForm(){
  line.value="";
  number.value="";
  place.value="";
  date.value="";
  memo.value="";
  photo.value="";
}

loadLogs();
</script>

</body>
</html>
